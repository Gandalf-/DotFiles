#!/bin/bash

c='openssl enc'; o='-aes-256-cbc -a -salt -k'; s=$(readlink -e $0)
echo -n "password: "; read -sr p; echo

{ echo "set -o pipefail; echo -n password: ; read -sr p; echo"
  echo "tail -n +3 \$(readlink -e \$0) | $c -d $o \$p | bash -s - \"\$@\"; exit"
  cat "$1" | $c -e $o $p;
} >"$2"
echo "done"
