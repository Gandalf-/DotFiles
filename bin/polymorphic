#!/usr/bin/env bash

c='openssl enc'; o='-aes-256-cbc -a -salt -k'
echo -n "password: "; read -sr p; echo

{ echo "set -o pipefail; echo -n password: ; read -sr p; echo"
  echo "tail -n +3 \"\$(readlink -e \"\$0\")\" | $c -d $o \"\$p\" | bash -s - \"\$@\"; exit"
  $c -e "$o" "$p" < "$1";
} >"$2"
echo "done"
